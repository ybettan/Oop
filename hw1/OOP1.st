Object subclass: #Monom	instanceVariableNames: 'exp coef'	classVariableNames: ''	poolDictionaries: ''	category: 'OOP1'!!Monom methodsFor: 'getters' stamp: 'yb 4/12/2018 10:26'!coef	^coef.! !!Monom methodsFor: 'getters' stamp: 'yb 4/12/2018 11:33'!derivative	|res|	res := Monom new.		"return 0^0 for constant derivative"	(self exp = 0)		ifTrue: [			res coef: 0 ; exp: 0.		  	^res			].	res coef: (self coef) * (self exp).	res exp: (self exp) - 1.	^res.! !!Monom methodsFor: 'getters' stamp: 'yb 4/12/2018 09:33'!exp	^exp.! !!Monom methodsFor: 'initialize-release' stamp: 'yb 4/12/2018 09:35'!initialize	exp := 0.	coef := 0.! !!Monom methodsFor: 'setters' stamp: 'yb 4/12/2018 10:27'!coef: anInteger	((anInteger isKindOf: Integer) not)		ifTrue: [self error: 'invalid input'].			coef := anInteger.! !!Monom methodsFor: 'setters' stamp: 'yb 4/12/2018 09:33'!exp: anInteger	(((anInteger isKindOf: Integer) not) or: (anInteger < 0))		ifTrue: [self error: 'invalid input'].			exp := anInteger.! !Object subclass: #Polynom	instanceVariableNames: 'monoms'	classVariableNames: ''	poolDictionaries: ''	category: 'OOP1'!!Polynom methodsFor: 'getters' stamp: 'yb 4/12/2018 15:00'!add: aPolynom	| res |	((aPolynom isKindOf: Polynom) not)		ifTrue: [self error: 'invalid input'].			res := Polynom new.	res := aPolynom deepCopy.	monoms keysDo: [:key | |m|						m := Monom new.						m exp: key deepCopy ; coef: ((monoms at: key) deepCopy).						res addMonom: m.						].	^res.	! !!Polynom methodsFor: 'getters' stamp: 'yb 4/12/2018 15:47'!asDictionary	^monoms deepCopy.! !!Polynom methodsFor: 'getters' stamp: 'yb 4/12/2018 14:44'!derivative	| res m |	res := Polynom new.	m := Monom new.	monoms keysDo: [:key | m exp: key ; coef: (monoms at: key).							m := m derivative.							res addMonom: m.						].	^res.! !!Polynom methodsFor: 'getters' stamp: 'yb 4/12/2018 14:54'!eval: anInteger	| res |	((anInteger isKindOf: Integer) not)		ifTrue: [self error: 'invalid input'].			res := 0.	monoms keysDo: [:key | |coef|						coef := monoms at: key.						res := res + (coef * (anInteger raisedToInteger: key)).						].	^res.! !!Polynom methodsFor: 'setters' stamp: 'yb 4/12/2018 16:30'!addMonom: aMonom	| exp coef |	((aMonom isKindOf: Monom) not)		ifTrue: [self error: 'invalid input'].			"don't keep monoms with coef = 0"	(aMonom coef = 0) ifTrue: [^1].			"don't let change on aMonom affect the Polynom"	exp := aMonom exp deepCopy.	coef := aMonom coef deepCopy.		"if exp is already in monomy then add the coefs else insert a new element"	monoms at: exp 		ifPresent: [:currentCoef | monoms at: exp put: currentCoef + coef] 		ifAbsent: [monoms at: exp put: coef].	! !!Polynom methodsFor: 'setters' stamp: 'yb 4/12/2018 16:45'!multipleByMonom: aMonom	| exp coef newCollection |	((aMonom isKindOf: Monom) not)		ifTrue: [self error: 'invalid input'].		"don't let future change on aMonom affect the Polynom"	exp := aMonom exp deepCopy.	coef := aMonom coef deepCopy.		newCollection := Dictionary new.	monoms keysDo: [:key | |newExp newCoef|						newExp := key + exp.						newCoef := (monoms at: key) * coef.						(newCoef ~= 0) 							ifTrue: [newCollection at: newExp put: newCoef.].						].	monoms := newCollection.			! !!Polynom methodsFor: 'initialize-release' stamp: 'yb 4/12/2018 15:46'!initialize	monoms := Dictionary new.! !